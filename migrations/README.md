# Description
The migration is a task performed by the admin whenever the database model is changed in `exportImport.models`.

## Performing migration
The following steps explain how to perform a migration:
1. Run the autogenerate alembic revision, this detects any changes in your database model compared to the SQL database. The following code needs to be run in the base directory of the project.
```bash
alembic revision --autogenerate -m "{your revision message}"
```
2. Check the migration code in `migrations.versions.{the-last-version}.py` if the autogenerated revision is correct. Read about the problems with autogenerate here: https://alembic.sqlalchemy.org/en/latest/autogenerate.html
3. Upgrade the database by running the following code:
```bash
alembic upgrade head
```
4. There are multiple ways an upgrade or downgrade can be done if a specific version is desired. The equivalent commands can be run using `downgrade` instead of `upgrade`. More information can be found here: https://alembic.sqlalchemy.org/en/latest/tutorial.html

## Setting up migration
The migration structure in this project is set up using the following command:
```bash
alembic init migrations
```
The migrations scripts and code have been changed to fit the `sqlmodel` packages, see: https://github.com/testdrivenio/fastapi-sqlmodel-alembic and https://github.com/testdrivenio/fastapi-sqlmodel-alembic

**ONLY IMPORTANT STEP:**
The only important thing to do to is to change the `sqlalchemy.url` variable to the sqlalchemy URL of the database for which the migrations are set up for. 